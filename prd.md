# RIV文件创建与编辑软件产品需求文档

## 1. 产品概述

**1.1 项目背景**  
Rive（原Rive动画）是一种基于矢量图形的实时动画格式（.riv），广泛应用于UI/UX交互原型、游戏界面、可交互图形等场景。当前主流创作工具为Rive官方编辑器，但市场缺乏轻量级、可定制、集成化、低成本的Riv文件生成解决方案。本产品旨在打造一款独立、易用的Riv文件创建与编辑软件，支持从图形绘制、动画制作到状态机交互设计的全流程，并能导出符合官方规范的.riv文件，兼容Rive各平台运行时。

**1.2 目标用户**  
- UI/UX设计师：制作交互动效、微交互动画。  
- 游戏开发者：为游戏界面制作动画资源。  
- 动态图形设计师：创作轻量矢量动画。  
- 教育机构：用于交互设计教学。  

**1.3 产品定位**  
一款跨平台的桌面端Riv文件创作工具，定位为Rive官方编辑器的替代/补充，强调易用性与功能完整性，同时保持对.riv文件格式的完全兼容。

---

## 2. 功能需求总览

| 功能模块         | 子模块                     | 优先级 | 描述 |
|------------------|---------------------------|--------|------|
| **1. 图形绘制与编辑** | 矢量图形绘制              | P0     | 提供基本形状绘制工具及钢笔工具 |
|                  | 路径编辑                  | P0     | 锚点编辑、曲线调整、路径合并/裁切 |
|                  | 颜色与填充                | P0     | 纯色、线性渐变、径向渐变、描边设置 |
|                  | 图层管理                  | P0     | 图层树、可见性、锁定、分组 |
|                  | 素材导入                  | P1     | 支持SVG、PNG、JPEG导入并矢量化 |
|                  | 变换操作                  | P0     | 移动、缩放、旋转、倾斜 |
| **2. 动画制作**     | 时间轴面板                | P0     | 关键帧、自动补间、缓动函数 |
|                  | 动画属性                  | P0     | 位置、旋转、缩放、透明度、颜色、路径等 |
|                  | 动画片段管理              | P0     | 多动画（Artboards）支持，命名与管理 |
|                  | 动画预览                  | P0     | 实时画布预览、循环/单次播放 |
|                  | 绑定与骨骼（可选）        | P2     | 矢量网格变形（如骨骼动画） |
| **3. 交互与状态机** | 状态机编辑器              | P0     | 可视化状态节点、过渡线 |
|                  | 输入触发器                | P1     | 鼠标点击、悬停、拖拽、键盘、时间事件 |
|                  | 动画状态                  | P0     | 每个状态可绑定动画片段 |
|                  | 条件过渡                  | P1     | 基于参数、布尔值的条件跳转 |
| **4. 文件与导出**   | 工程文件（.rivproj）      | P0     | 保存可编辑的源文件 |
|                  | 导出Riv                  | P0     | 生成标准.riv二进制文件 |
|                  | 导出其他格式              | P2     | PNG序列、GIF、SVG、Lottie（可选） |
|                  | 资源打包                  | P1     | 自动收集所有嵌入资源 |
| **5. 用户界面**     | 主画布                    | P0     | 无限画布、缩放拖拽、参考线、网格 |
|                  | 工具栏                    | P0     | 可停靠/浮动，工具图标清晰 |
|                  | 属性面板                  | P0     | 上下文敏感，实时编辑参数 |
|                  | 资源库                    | P1     | 内置矢量图标库、颜色预设 |
| **6. 协作与扩展**   | 版本历史                  | P2     | 本地历史快照，撤销/重做栈 |
|                  | 插件系统                  | P3     | 支持自定义导出脚本、工具扩展 |

---

## 3. 详细功能描述

### 3.1 图形绘制与编辑模块

**3.1.1 矢量图形绘制**  
- **基础形状**：矩形、圆角矩形、椭圆、多边形（3~8边）、星形。  
- **钢笔工具**：绘制贝塞尔曲线路径，支持添加/删除锚点、转换锚点类型（尖角/平滑）。  
- **铅笔工具**：自由手绘路径，自动简化曲线。  
- **文本工具**：支持静态文本，可设置字体、字号、颜色、对齐方式（P1）。  
- **布尔运算**：路径合并、减去、交集、排除重叠（P1）。  

**3.1.2 路径编辑**  
- **直接选择工具**：选择并移动锚点/手柄。  
- **路径修整**：端点吸附、平均分布、平滑化。  
- **轮廓化描边**：将描边转换为填充路径。  

**3.1.3 颜色与填充**  
- **填充类型**：纯色、线性渐变、径向渐变、无填充。  
- **描边**：纯色描边、宽度（可设置端点样式、角点样式）、虚线设置。  
- **透明度**：独立控制填充/描边透明度。  
- **吸管工具**：从画布任意位置拾取颜色。  

**3.1.4 图层管理**  
- **图层列表**：树状结构，显示图形、组、蒙版。  
- **图层操作**：重命名、锁定、隐藏、删除、复制。  
- **图层分组**：可将多个对象编组，统一变换。  
- **蒙版**：支持剪贴蒙版，上层图形作为下层图形的蒙版（P1）。  

**3.1.5 素材导入**  
- 导入SVG文件，保留矢量路径及颜色。  
- 导入PNG/JPEG，作为位图图像嵌入（无法直接矢量化，P1支持）。  
- 拖拽导入：直接将文件拖入画布或资源库。  

**3.1.6 变换操作**  
- 自由变换：移动、缩放（沿中心/对角）、旋转（角度数值输入）、倾斜（P1）。  
- 对齐分布：相对于画布、选择对象、关键对象的对齐与分布工具。  

---

### 3.2 动画制作模块

**3.2.1 时间轴面板**  
- **轨道结构**：每个图层属性（位置、旋转、缩放、透明度等）独立轨道，可折叠。  
- **关键帧**：支持手动添加/删除关键帧，拖动调整时间位置。  
- **自动补间**：关键帧之间自动生成线性/缓动插值。  
- **缓动预设**：线性、缓入、缓出、弹性、弹跳等；支持自定义三次贝塞尔曲线。  
- **时间标尺**：显示帧刻度（FPS默认60，可自定义），当前时间指示器（CTI）。  

**3.2.2 动画属性支持**  
- **基础属性**：X/Y位置、旋转角度、缩放比例、透明度。  
- **颜色属性**：填充色、描边色、渐变颜色偏移。  
- **路径属性**：路径形状关键帧（顶点位置、曲线手柄），支持形变动画（P1）。  
- **其他**：描边宽度、圆角半径、模糊（P2）。  

**3.2.3 动画片段管理**  
- **Artboard（画板）机制**：每个画板可包含独立图形及多个动画片段。  
- **动画片段**：命名、时长设置、循环模式（单次、循环、往复）。  
- **片段触发**：可在状态机中引用。  

**3.2.4 动画预览**  
- 画布实时播放动画。  
- 支持逐帧查看，时间轴滚动。  
- 可设置预览画质（草稿/高质量）。  

**3.2.5 绑定与骨骼（进阶功能）**  
- 将多个图形绑定至骨骼层级，支持IK（反向动力学）约束（P2）。  
- 骨骼动画自动生成顶点权重（P2）。  

---

### 3.3 交互与状态机模块

**3.3.1 状态机编辑器**  
- **可视化节点**：用节点表示状态，用连线表示过渡。  
- **状态属性**：每个状态关联一个动画片段。  
- **根状态/进入状态**：默认入口。  
- **参数面板**：定义布尔值、数值型、触发型参数，供条件判断。  

**3.3.2 输入触发器**  
- **鼠标事件**：悬停、按下、释放、拖拽进入/离开、点击。  
- **键盘事件**：按键按下/释放（P2）。  
- **时间事件**：经过N秒后自动触发（P2）。  
- **自定义事件**：字符串命名，可由运行时发送。  

**3.3.3 条件过渡**  
- 可设置无条件的立即跳转。  
- 基于参数比较（例如：数值大于10，布尔值为真）。  
- 支持多条件组合（与/或逻辑）（P1）。  

**3.3.4 交互区域**  
- 可将任意图形设置为交互热区，响应用户输入。  

---

### 3.4 文件与导出模块

**3.4.1 工程文件（.rivproj）**  
- 保存所有编辑数据（图形、动画、状态机、资源引用）。  
- JSON格式或二进制格式，确保快速读写与版本兼容。  
- 自动备份机制（每N分钟自动保存临时文件）。  

**3.4.2 导出Riv**  
- 严格按照Rive官方二进制规范生成.riv文件。  
- 支持导出选项：压缩级别、包含调试信息（便于运行时调试）。  
- 验证导出文件：内置校验工具，可打开并预览导出的.riv文件内容。  

**3.4.3 导出其他格式**  
- 导出为PNG序列（含透明背景），帧率可选。  
- 导出为GIF（P2）。  
- 导出为SVG（矢量静态图形）（P2）。  
- 导出为Lottie（JSON）实验性支持（P3）。  

**3.4.4 资源打包**  
- 导出时将所有嵌入图像/字体打包进单一.riv文件。  
- 提供“导出资源清单”功能，列出所有外部依赖。  

---

### 3.5 用户界面与体验

**3.5.1 主画布**  
- 无限画布背景，可设置颜色/网格。  
- 缩放范围：1%~1600%，支持快捷键（Ctrl + 滚轮）。  
- 平移画布：空格键拖拽/手型工具。  
- 参考线与智能对齐：可拖出参考线，对齐边缘/中心。  

**3.5.2 工具栏**  
- 默认停靠在左侧，图标+文字提示。  
- 工具分组：选择工具、形状工具、绘图工具、变换工具、辅助工具。  
- 可自定义工具栏布局（P2）。  

**3.5.3 属性面板**  
- 右侧面板，根据当前选中对象显示可编辑属性。  
- 支持数值滑块、颜色拾取器、下拉选择等控件。  
- 可折叠分组（如“外观”、“变换”、“高级”）。  

**3.5.4 资源库**  
- 内置图标库：Material Icons、FontAwesome子集（P2）。  
- 用户资源：已导入的SVG、位图、颜色样式、文本样式。  
- 拖拽应用：从库中拖拽至画布即可生成实例。  

**3.5.5 工作区布局**  
- 支持多种预设布局（设计、动画、状态机）。  
- 面板自由浮动/吸附。  
- 深色/浅色主题切换（P1）。  

---

### 3.6 协作与扩展（进阶）

**3.6.1 版本历史**  
- 本地维护操作历史（撤销/重做无限制，可设置最大步数）。  
- 自动快照：每30分钟或关键操作（保存前）创建快照，用户可回滚。  

**3.6.2 插件系统**  
- 提供JavaScript/TypeScript SDK，允许第三方开发插件。  
- 插件可扩展：新导出格式、新动画算法、新形状生成器等。  
- 插件管理面板（安装、启用、停用）。  

---

## 4. 非功能性需求

**4.1 性能**  
- 启动时间：< 3秒（SSD环境）。  
- 实时渲染：60 FPS，支持至少1000个矢量节点（普通配置PC）。  
- 内存占用：编辑500个图形+30秒动画时，内存 < 1GB。  

**4.2 兼容性**  
- 操作系统：Windows 10/11（64位）、macOS 11+、Linux（Ubuntu 20.04+）。  
- .riv文件：兼容Rive官方Runtime 2.0+版本。  

**4.3 易用性**  
- 提供新手引导向导/交互式教程。  
- 快捷键体系贴近Adobe Illustrator/After Effects。  
- 工具提示、属性描述详实。  

**4.4 可靠性**  
- 连续运行24小时不崩溃。  
- 自动恢复功能：软件意外退出后，重启时恢复未保存内容。  

**4.5 国际化**  
- 界面语言：英语、简体中文（首版至少支持英语）。  
- 日期时间、数字格式本地化。
